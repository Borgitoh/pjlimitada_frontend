<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-gray-900">Finalizar Compra</h1>
      <p class="text-gray-600 mt-2">Complete suas informações para finalizar o pedido</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">

      <!-- Checkout Form -->
      <div class="lg:col-span-2">
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">

          <!-- Progress Steps -->
          <div class="mb-8">
            <div class="flex items-center">
              <div *ngFor="let step of steps; let i = index" class="flex items-center">
                <div class="flex items-center">
                  <div
                    class="h-8 w-8 rounded-full flex items-center justify-center text-sm font-medium"
                    [class.bg-pj-cyan]="currentStep >= i + 1"
                    [class.text-white]="currentStep >= i + 1"
                    [class.bg-gray-200]="currentStep < i + 1"
                    [class.text-gray-500]="currentStep < i + 1">
                    {{i + 1}}
                  </div>
                  <span class="ml-2 text-sm font-medium"
                        [class.text-pj-cyan]="currentStep >= i + 1"
                        [class.text-gray-500]="currentStep < i + 1">
                    {{step}}
                  </span>
                </div>
                <div *ngIf="i < steps.length - 1"
                     class="ml-4 h-0.5 w-16 bg-gray-200"
                     [class.bg-pj-cyan]="currentStep > i + 1"></div>
              </div>
            </div>
          </div>

          <!-- Step 1: Customer Information -->
          <div *ngIf="currentStep === 1">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Informações Pessoais</h3>
            <form [formGroup]="customerForm" class="space-y-4">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="nome" class="block text-sm font-medium text-gray-700 mb-1">Nome Completo *</label>
                  <input
                    id="nome"
                    formControlName="nome"
                    type="text"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="Seu nome completo">
                </div>
                <div>
                  <label for="email" class="block text-sm font-medium text-gray-700 mb-1">E-mail *</label>
                  <input
                    id="email"
                    formControlName="email"
                    type="email"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="seu@email.com">
                </div>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="telefone" class="block text-sm font-medium text-gray-700 mb-1">Telefone *</label>
                  <input
                    id="telefone"
                    formControlName="telefone"
                    type="tel"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="(11) 99999-9999">
                </div>
                <div>
                  <label for="cpf" class="block text-sm font-medium text-gray-700 mb-1">CPF *</label>
                  <input
                    id="cpf"
                    formControlName="cpf"
                    type="text"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="000.000.000-00">
                </div>
              </div>
            </form>
          </div>

          <!-- Step 2: Shipping Address -->
          <div *ngIf="currentStep === 2">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Endereço de Entrega</h3>
            <form [formGroup]="addressForm" class="space-y-4">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="cep" class="block text-sm font-medium text-gray-700 mb-1">CEP *</label>
                  <input
                    id="cep"
                    formControlName="cep"
                    type="text"
                    (blur)="buscarCep()"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="00000-000">
                </div>
                <div>
                  <label for="cidade" class="block text-sm font-medium text-gray-700 mb-1">Cidade *</label>
                  <input
                    id="cidade"
                    formControlName="cidade"
                    type="text"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="Sua cidade">
                </div>
              </div>
              <div>
                <label for="endereco" class="block text-sm font-medium text-gray-700 mb-1">Endereço *</label>
                <input
                  id="endereco"
                  formControlName="endereco"
                  type="text"
                  class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                  placeholder="Rua, avenida, etc.">
              </div>
              <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div>
                  <label for="numero" class="block text-sm font-medium text-gray-700 mb-1">Número *</label>
                  <input
                    id="numero"
                    formControlName="numero"
                    type="text"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="123">
                </div>
                <div>
                  <label for="complemento" class="block text-sm font-medium text-gray-700 mb-1">Complemento</label>
                  <input
                    id="complemento"
                    formControlName="complemento"
                    type="text"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="Apto 101">
                </div>
                <div>
                  <label for="bairro" class="block text-sm font-medium text-gray-700 mb-1">Bairro *</label>
                  <input
                    id="bairro"
                    formControlName="bairro"
                    type="text"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent"
                    placeholder="Centro">
                </div>
                <div>
                  <label for="estado" class="block text-sm font-medium text-gray-700 mb-1">Estado *</label>
                  <select
                    id="estado"
                    formControlName="estado"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pj-cyan focus:border-transparent">
                    <option value="">UF</option>
                    <option value="SP">SP</option>
                    <option value="RJ">RJ</option>
                    <option value="MG">MG</option>
                    <!-- Add more states as needed -->
                  </select>
                </div>
              </div>
            </form>
          </div>

          <!-- Step 3: Payment Method -->
          <div *ngIf="currentStep === 3">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Forma de Pagamento</h3>
            <div class="space-y-3">
              <div *ngFor="let method of paymentMethods"
                   class="border border-gray-200 rounded-lg p-4 cursor-pointer hover:border-pj-cyan transition-colors"
                   [class.border-pj-cyan]="selectedPaymentMethod === method.id"
                   [class.bg-blue-50]="selectedPaymentMethod === method.id"
                   (click)="selectPaymentMethod(method.id)">
                <div class="flex items-center">
                  <input
                    type="radio"
                    [checked]="selectedPaymentMethod === method.id"
                    class="h-4 w-4 text-pj-cyan focus:ring-pj-cyan border-gray-300">
                  <div class="ml-3 flex-1">
                    <div class="flex items-center">
                      <div class="h-8 w-8 bg-gray-100 rounded-lg flex items-center justify-center mr-3">
                        <svg class="h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path *ngIf="method.icon === 'credit-card'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
                          <path *ngIf="method.icon === 'smartphone'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
                          <path *ngIf="method.icon === 'bank'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                      </div>
                      <div>
                        <p class="font-medium text-gray-900">{{method.name}}</p>
                        <p class="text-sm text-gray-500">{{method.description}}</p>
                        <p class="text-xs text-gray-400 mt-1">{{method.processingTime}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Navigation Buttons -->
          <div class="flex justify-between mt-8 pt-6 border-t border-gray-200">
            <button
              *ngIf="currentStep > 1"
              (click)="previousStep()"
              class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
              Voltar
            </button>
            <div *ngIf="currentStep === 1"></div>

            <button
              *ngIf="currentStep < 3"
              (click)="nextStep()"
              [disabled]="!canProceed()"
              class="px-6 py-2 bg-pj-cyan text-white rounded-lg hover:bg-pj-cyan-hover transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
              Continuar
            </button>

            <button
              *ngIf="currentStep === 3"
              (click)="finishOrder()"
              [disabled]="processing || !canProceed()"
              class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
              <span *ngIf="!processing">Finalizar Pedido</span>
              <span *ngIf="processing" class="flex items-center">
                <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Processando...
              </span>
            </button>
          </div>
        </div>
      </div>

      <!-- Order Summary -->
      <div class="lg:col-span-1">
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 sticky top-8">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">Resumo do Pedido</h3>

          <!-- Cart Items -->
          <div class="space-y-3 mb-4">
            <div *ngFor="let item of cartSummary.items" class="flex items-center space-x-3">
              <img [src]="item.imagem" [alt]="item.nome" class="h-12 w-12 object-cover rounded-lg">
              <div class="flex-1 min-w-0">
                <p class="text-sm font-medium text-gray-900 truncate">{{item.nome}}</p>
                <p class="text-xs text-gray-500">Qtd: {{item.quantidade}}</p>
              </div>
              <p class="text-sm font-semibold text-gray-900">R$ {{(item.preco * item.quantidade) | number:'1.2-2'}}</p>
            </div>
          </div>

          <!-- Summary -->
          <div class="border-t border-gray-200 pt-4 space-y-2">
            <div class="flex justify-between text-sm">
              <span class="text-gray-600">Subtotal:</span>
              <span class="font-medium">R$ {{cartSummary.subtotal | number:'1.2-2'}}</span>
            </div>
            <div class="flex justify-between text-sm">
              <span class="text-gray-600">Frete:</span>
              <span class="font-medium text-green-600">Grátis</span>
            </div>
            <div class="flex justify-between text-base font-semibold border-t border-gray-200 pt-2">
              <span class="text-gray-900">Total:</span>
              <span class="text-pj-cyan">R$ {{cartSummary.total | number:'1.2-2'}}</span>
            </div>
          </div>

          <!-- Security Badge -->
          <div class="mt-6 text-center">
            <div class="flex items-center justify-center text-sm text-gray-500">
              <svg class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
              </svg>
              Compra 100% segura
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
